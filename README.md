# ğŸ¦ AML Fraud Detection â€” Machine Learning Graduation Project

[![Streamlit App](https://static.streamlit.io/badges/streamlit_badge_black_white.svg)](https://your-app-name.streamlit.app)
[![Python 3.11](https://img.shields.io/badge/Python-3.11-blue.svg)](https://www.python.org/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

**Author:** Khalid Dharif | Graduation Project  
**Dataset:** [IBM Transactions for Anti-Money Laundering (AML)](https://www.kaggle.com/datasets/ealtman2019/ibm-transactions-for-anti-money-laundering-aml)

---

## ğŸ“Œ Project Overview

Money laundering costs the global economy an estimated **$800 billion â€“ $2 trillion/year** (UNODC).  
This project builds a complete, production-ready ML pipeline that detects suspicious financial transactions using IBM's synthetic AML dataset (~500K transactions, ~0.2% fraud rate).

### Fraud Operations Enhancements (2026-02-28)
- Policy-driven thresholding (`Aggressive Detection`, `Balanced`, `Precision Focus`)
- Analyst-ready reason codes for each alert (why the model flagged a transaction)
- Case triage outputs: `Priority Score`, `Queue (P1-P4)`, `Next Action`, and `SLA`
- Hardened batch scoring with safer numeric parsing and validation-aware outputs
- New **Operations Dashboard** for live session monitoring and queue workload visibility

### Live Demo
ğŸ‘‰ [**Try the Streamlit App â†’**](http://localhost:8511/)

---

## ğŸ§  Models Compared (6 Classifiers)

| Model | Family | Typical AUC |
|-------|--------|-------------|
| Logistic Regression | Linear | ~0.877 |
| Decision Tree | Tree | ~0.903 |
| Random Forest | Bagging | ~0.935 |
| XGBoost | Boosting | ~0.926 |
| **LightGBM** | Boosting | **~0.938** |
| **CatBoost** | Boosting | **~0.940** |

---

## ğŸ“ Project Structure

```
aml-fraud-detection/
â”‚
â”œâ”€â”€ app.py                          # Streamlit web application
â”œâ”€â”€ requirements.txt                # Python dependencies
â”œâ”€â”€ README.md                       # This file
â”‚
â”œâ”€â”€ GP_AML_Khalid_Dharif_v2.ipynb  # Full ML notebook (train here)
â”‚
â””â”€â”€ models/                         # Saved model artifacts (generated by notebook)
    â”œâ”€â”€ aml_best_model.joblib
    â”œâ”€â”€ aml_scaler.joblib
    â”œâ”€â”€ aml_le_from_bank.joblib
    â”œâ”€â”€ aml_le_to_bank.joblib
    â”œâ”€â”€ aml_le_bank_pair.joblib
    â”œâ”€â”€ aml_le_currency.joblib
    â”œâ”€â”€ aml_le_format.joblib
    â”œâ”€â”€ aml_feature_columns.joblib
    â””â”€â”€ aml_model_name.joblib
```

## ğŸ“Š Pipeline Summary

```
Raw CSV
  â””â”€â”€ EDA (class imbalance, fraud patterns, temporal heatmaps)
       â””â”€â”€ Feature Engineering (time features, Amount_Diff, fraud history)
            â””â”€â”€ Preprocessing (LabelEncoder â†’ stratified split â†’ SMOTE â†’ StandardScaler)
                 â””â”€â”€ Training (6 classifiers)
                      â””â”€â”€ Evaluation (ROC-AUC, PR curve, confusion matrices, radar chart)
                           â””â”€â”€ Best Model â†’ joblib artifacts â†’ Streamlit App
```

---

## ğŸ”‘ Key Features Engineered

| Feature | Why |
|---------|-----|
| `Amount_Diff` | FX-conversion laundering leaves paidâ‰ received gap |
| `From_Bank_Fraud_History` | Repeat-offender banks are strongest predictor |
| `Bank_Pair_Fraud_History` | Specific corridors are systematically exploited |
| `Is_High_Risk_Hour` | Midnightâ€“6AM = reduced oversight |
| `Is_Weekend` | Weekend transactions face less monitoring |

---

## ğŸ“„ License
MIT License â€” free to use, modify, and distribute with attribution.

---

*Graduation Project Â· Khalid Dharif Â· IBM AML Dataset*
